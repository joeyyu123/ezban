<!DOCTYPE html>

<html lang="zh-hant"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:fragment="head">

    <!-- Basic Page Needs
    ================================================== -->
    <meta charset="utf-8">
    <title>ezban-活動報名平台</title>
    <!-- Mobile Specific Metas
    ================================================== -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Construction Html5 Template">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <!-- theme meta -->
    <meta name="theme-name" content="aviato"/>
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" th:href="@{images/ez_logo.png}"/>
    <!-- Themefisher Icon font -->
    <link rel="stylesheet" th:href="@{/plugins/themefisher-font/style.css}">
    <!-- bootstrap.min css th:-->
    <link rel="stylesheet" th:href="@{/plugins/bootstrap/css/bootstrap.min.css}">
    <!-- Animate css -->
    <link rel="stylesheet" th:href="@{/plugins/animate/animate.css}">
    <!-- Slick Carousel -->
    <link rel="stylesheet" th:href="@{/plugins/slick/slick.css}">
    <link rel="stylesheet" th:href="@{/plugins/slick/slick-theme.css}">
    <!-- Main Stylesheet -->
    <link rel="stylesheet" th:href="@{/css/frontstage/style.css}">
    <!-- bootstrap icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
    <!-- Mait jQuery -->
    <script th:src="@{/plugins/jquery/dist/jquery.min.js}"></script>
    <script th:src="@{/plugins/jquery/dist/jquery-3.7.1.min.js}"></script>
    <!-- Bootstrap 3.1 -->
    <script th:src="@{/plugins/bootstrap/js/bootstrap.min.js}"></script>
    <!-- Bootstrap Touchpin -->
    <script th:src="@{/plugins/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js}"></script>
    <!-- Instagram Feed Js -->
    <script th:src="@{/plugins/instafeed/instafeed.min.js}"></script>
    <!-- Video Lightbox Plugin -->
    <script th:src="@{/plugins/ekko-lightbox/dist/ekko-lightbox.min.js}"></script>
    <!-- Count Down Js -->
    <script th:src="@{/plugins/syo-timer/build/jquery.syotimer.min.js}"></script>
    <!-- Main Js File -->
    <script th:src="@{/js/frontstage/script.js}"></script>
    <!-- sweetalert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- jquery/3.5.1 -->
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->
    <!-- slick Carousel -->
    <script th:src="@{/plugins/slick/slick.min.js}"></script>
    <script th:src="@{/plugins/slick/slick-animation.min.js}"></script>
    <!-- font-awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script th:src="@{/js/frontstage/product/cartqty.js}"></script>

</head>

<body id="body" th:data-member-no="${memberNo}" onload="initFavorites()">

<!-- Start Top Header Bar -->
<section th:fragment="header" class="top-header">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-xs-12 col-sm-6">
                <ul class=" top-menu list-inline">
                    <li class="logo text-center">
                        <a th:href="@{/}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="134.375" height="50">
                                <image th:href="@{/images/ezban.png}" width="108.5" height="35"/>
                            </svg>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="col-md-6 col-xs-12 col-sm-6">
                <!-- Cart -->
                <ul class="top-menu text-right list-inline">
                    <li class="cart-nav">
                        <a th:href="@{/cart/items}">
                            <div class="cart-icon" style="margin-right: 3px;">
                                <i class="bi bi-cart3">
                                    <span class="badge">0</span>
                                </i>
                            </div>
                            <span class="top-menu-text">購物車</span>
                        </a>

                    </li><!-- / Cart -->

<!--                    &lt;!&ndash; Search &ndash;&gt;-->
<!--                    <li class="dropdown search dropdown-slide">-->
<!--                        <a href="#!" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">-->
<!--                            <i class="tf-ion-ios-search-strong"></i><span class="top-menu-text">搜尋</span></a>-->
<!--                        <ul class="dropdown-menu search-dropdown">-->
<!--                            <li>-->
<!--                                <form th:action="@{/search}" action="post"><input type="search" class="form-control"-->
<!--                                                                                  placeholder="Search..."></form>-->
<!--                            </li>-->
<!--                        </ul>-->
<!--                    </li>&lt;!&ndash; / Search &ndash;&gt;-->

                    <!-- Member -->
                    <li class="dropdown member-nav dropdown-slide">
                        <a href="#!" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-person-fill" viewBox="2 -3 16 16">
                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                            </svg>
                            <span class="top-menu-text">會員</span></a>
                        <ul class="dropdown-menu">
                            <li sec:authorize="!hasRole('ROLE_Member')" style="display: flex; justify-content: center; align-items: center;">
                                <a href="/registerPage"><span><i class="fa-solid fa-user"></i> 加入會員</span></a>
                            </li>
                            <li sec:authorize="!hasRole('ROLE_Member')" style="display: flex; justify-content: center; align-items: center;">
                                <a href="/loginPage"><span><i class="fa-solid fa-right-to-bracket"></i>  登入 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></a>
                            </li>
                             <li  style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="/members/memberCenterPage"><span><i
                                        class="fa-brands fa-shopify"></i> 會員中心</span></a>
                            </li >
                            <li  style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="/eventCommentsReview/commentReviewPage"><span><i
                                        class="fa-brands fa-shopify"></i> 我的評論</span></a>
                            </li >
                            <li  style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="/productorder/findByMember"><span><i
                                        class="fa-brands fa-shopify"></i> 我的商品訂單</span></a>
                            </li >
                            <li style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="/events/orders"><span><i
                                        class="fa-brands fa-shopify"></i> 我的票券訂單</span></a>
                            </li>
                            <li style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a th:href="@{/saveevent/findByMember/{memberNo}(memberNo=${memberNo})}">
                                    <span><i class="fa-solid fa-bookmark"></i> 我的活動追蹤</span>
                                </a>
                            </li>
                            <li style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="/saveproduct/findByMember"><span><i
                                        class="fa-solid fa-bookmark"></i> 我的商品追蹤</span></a>
                            </li>
                            <!-- birthdaycoupon/check -->
                            <li style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="#" id="check-coupons-btn" data-toggle="modal" data-target="#myModal" ><span>生日禮券</span></a>
                            </li>
                            <li style="display: flex; justify-content: center; align-items: center;" sec:authorize="hasRole('ROLE_Member')">
                                <a href="/logout"><span><i
                                        class="fa-solid fa-right-from-bracket"></i> 登出</span></a>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a th:href="@{/backstage}" class="btn btn-primary custom-btn" role="button"><i class="fa-solid fa-handshake"></i> 辦活動</a>
                    </li>
                </ul><!-- / .nav .navbar-nav .navbar-right -->
            </div>
        </div>
    </div>
</section><!-- End Top Header Bar -->


<!-- Main Menu Section -->
<section class="menu" style="height: 50px;">
    <nav class="navbar navigation" style="height: 50px;">
        <div class="container" style="height: 50px;">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                        aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

            </div><!-- / .navbar-header -->
            <!-- Navbar Links -->
            <div id="navbar" class="navbar-collapse collapse text-center">
                <ul class="nav navbar-nav">
<!--                    <li class="dropdown ">-->
<!--                        <a href="#" style="padding: 15px;">聯絡我們</a>-->
<!--                    </li>-->
                    <!-- Products -->
                    <li class="dropdown dropdown-slide">
                        <a th:href="@{/product/shopall}" role="button" style="padding: 15px;">周邊商品</a>
                    </li><!-- / Products -->

                    <!-- Events -->
                    <li class="dropdown dropdown-slide">
                        <a th:href="@{/events}" role="button" style="padding: 15px;">所有活動</a>
                    </li><!-- / Events -->

                    <!-- QA -->
                    <li class="dropdown ">
                        <a th:href="@{/qa}" style="padding: 15px;">常見問題</a>
                    </li>

                </ul><!-- / .nav .navbar-nav -->
                <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
                    <div class="modal-dialog modal-sm" role="document">
                        <div class="modal-content">
                            <div class="modal-body">
                                <p id="message-content"></p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!--/.navbar-collapse -->
        </div><!-- / .container -->
    </nav>
</section>

<div class="event_carousel autoplay" style="margin-top: 40px;">
    <div th:each="event : ${events}"><a th:href="@{'/events/' + ${event.eventNo}}"><img th:src="'data:image/jpeg;base64, '+${event.eventImg}" alt="event-img"></a></div>
</div>

<section class="events section">
    <div class="events container">
        <div class="row">
            <div class="title text-center">
                <h2>探索活動</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4" th:each="event : ${events}">
                <div class="product-item">
                    <div class="product-thumb">
                        <img class="img-responsive" th:src="'data:image/jpeg;base64, '+${event.eventImg}"
                             alt="event-img" style="height: 100%; object-fit: cover;"/>
                        <div class="preview-meta">
                            <ul>
                                <li>
                                    <a th:href="@{'/events/' + ${event.eventNo}}"><i
                                            class="tf-ion-ios-search-strong"></i></a>
                                </li>
                                <li>
                                    <a href="#!" th:data-event-no="${event.eventNo}" onclick="toggleFavorite(this, event)"><i class="tf-ion-ios-heart"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="product-content event-content">
                        <h4><a th:href="@{'/events/' + ${event.eventNo}}" th:text="${event.eventName}"></a></h4>
                        <p class="date"
                           th:text="${#dates.format(event.eventStartTime, 'yyyy-MM-dd HH:mm')} + ' ~ ' + ${#dates.format(event.eventEndTime, 'yyyy-MM-dd HH:mm')}"></p>
                        <div class="small-info">
                            <div class="event-location">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="#989797"
                                     class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                    <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/>
                                </svg>
                                <span class="location" th:text="${event.eventCity}"></span>
                            </div>
                            <div class="visit-count">
                                <i class="fa-regular fa-eye"></i>
                                <span class="location" th:text="${event.visitCount}"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="see_more">
            <a th:href="@{/events}">查看更多</a>
        </div>
    </div>
</section>

<section class="products section">
    <div class="products container">
        <div class="row">
            <div class="title text-center">
                <h2>精選商品</h2>
            </div>
        </div>
        <div class="row" id="index_products">
            <!-- 動態顯示商品 -->
        </div>
        <div class="see_more">
            <a th:href="@{/product/shopall}">查看更多</a>
        </div>
    </div>
</section>



<!--
Start Call To Action
==================================== -->


<footer th:fragment="footer" class="footer section text-center">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="social-media">
                    <li>
                        <a th:href="@{/}"><img th:src="@{/images/ez_logo.png}" alt="logo"
                                                   style="width: 44.48px; height: 40px;"></a>
                    </li>
                </div>
                <p class="copyright-text" style="margin-top: 50px;">
                    Copyright &copy; <a target="_blank" href="#">ez辦 All
                    Rights Reserved.</a></p>
            </div>
        </div>
    </div>
</footer>
<script th:src="@{/js/frontstage/saveevent/saveevent.js}"></script>
<script th:src="@{/js/frontstage/index2.js}"></script>

<script>
// 獲取模態框元素
var modal = document.getElementById("myModal");


// 綁定按鈕事件
document.getElementById('check-coupons-btn').addEventListener('click', function(event) {
    event.preventDefault();
    checkCoupons();
});

function checkCoupons() {
    fetch('/api/birthdaycoupon/check')
        .then(response => response.text())
        .then(data => {
            showModal(data);
        })
        .catch(error => console.error('Error:', error));
}

function showModal(message) {
    document.getElementById('message-content').innerText = message;
}


</script>
</body>
</html>
